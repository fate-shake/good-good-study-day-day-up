# 性能优化
为什么要优化？从哪里开始优化？

优化的目的就是使用户浏览网页的时候获得更好的体验，同时减少服务器的性能消耗

要优化页面，首先要了解页面是如何渲染的。

从输入URL到页面加载发生了什么？

1、DNS解析

2、TCP连接

3、发送HTTP请求

4、服务器响应并返回HTTP报文

5、浏览器解析报文并渲染页面

6、连接结束

其中第五步中：

浏览器解析HTML文件生成DOM树，然后解析css文件生成CSSOM树，然后将DOM树与CSSOM树组合成render树，然后浏览器将render树渲染在屏幕上；其中有涉及两个概念：回流(reflow)和重绘(repaint);

> 当页面元素的大小、位置等发生改变时，会触发回流；

> 当页面元素的颜色、背景等发生改变时，会触发重绘；

> 回流必定重绘，重绘不一定回流；

> 回流的代价比重绘大的多；

可以看出，前端能够做的优化主要在第五步；

优化方法

1、因为浏览器对同时请求的数量限制，我们可以减少资源的请求数量，合并资源：合并代码，雪碧图；

2、减小请求资源的大小：压缩代码、使用字体图标、base64图片等；

3、服务端启用gzip；

4、使用缓存；

5、减少代码中的内存溢出；

最后，首屏渲染时尽量少操作DOM，触发回流和重绘

> 2019/5/6